# redis 数据结构

> 参考1: https://mp.weixin.qq.com/s/f9N13fnyTtnu2D5sKZiu9w  
> 参考2: https://juejin.im/entry/6844903433665773576

- 当我们在本文中提到 Redis 的**数据结构**，可能是在两个不同的层面来讨论它。

- 第一个层面，是从**使用者**的角度，这一层面也是 Redis **暴露给外部的调用接口**。比如：
    - **string**
    - **list**
    - **hash**
    - **set**
    - **sorted set**   

- 第二个层面，是从**内部实现**的角度，属于更底层的实现。比如：
    - **dict**
    - **sds**
    - **ziplist**
    - **quicklist**
    - **skiplist**

- 本部分的重点在于讨论第二个层面，
    1. **Redis 数据结构的内部实现**

    2. **这两个层面的数据结构之间的关系**，Redis 如何通过组合第二个层面的各种基础数据结构来实现第一个层面的更高层的数据结构。

- 在讨论任何一个系统的内部实现的时候，我们都要先明确它的**设计原则**，这样我们才能更深刻地理解它为什么会进行如此设计的真正意图。在本文接下来的讨论中，我们主要关注以下几点：
    1. **存储效率**
        - Redis 是专用于存储数据的，它对于**计算机资源的主要消耗就在于内存**，因此节省内存是它非常非常重要的一个方面。这意味着 Redis 一定是非常精细地考虑了压缩数据、减少内存碎片等问题。

    2. **快速响应时间**
        - 与快速响应时间相对的，是**高吞吐量**。Redis是用于提供在线访问的，对于单个请求的响应时间要求很高，因此，快速响应时间是比高吞吐量更重要的目标。有时候，这两个目标是矛盾的。

    3. **单线程**。
        - Redis 的性能瓶颈不在于 CPU 资源，而在于**内存访问和网络 IO**。

        - 而采用单线程的设计带来的好处是，**极大简化了数据结构和算法的实现**。

        - 相反，Redis 通过**异步 IO 和 pipelining** 等机制来实现高速的并发访问。

        - 显然，单线程的设计，对于单个请求的快速响应时间也提出了更高的要求。