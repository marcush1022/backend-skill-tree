# **管道**

- 大多数同学一直以来对 Redis 管道有一个误解，他们以为这是 Redis 服务器提供的一种特别的技术，有了这种技术就可以加速 Redis 的存取效率。
    - **但是实际上 Redis 管道（Pipeline）本身并不是 Redis 服务器直接提供的技术，这个技术本质上是由客户端提供的，跟服务器没有什么直接的关系**。

<br>

## **1. Redis 的消息交互**
- 当我们使用客户端对 Redis 进行一次操作时，如下图所示，**客户端将请求传送给服务器，服务器处理完毕后，再将响应回复给客户端。这要花费一个`网络数据包来回`的时间**。

- 如果连续执行多条指令，那就会花费**多个网络数据包来回**的时间。

- 回到客户端代码层面，客户端是经历了**写-读-写-读**四个操作才完整地执行了两条指令。

- 现在如果我们调整读写顺序，改成**写—写-读-读**，这两个指令同样可以正常完成。

- 两个连续的写操作和两个连续的读操作总共只会花费一次网络来回，就好比**连续的 `write` 操作合并了，连续的 `read` 操作也合并了一样**。

- 这便是管道操作的本质，**服务器根本没有任何区别对待，还是收到一条消息，执行一条消息，回复一条消息的正常的流程。客户端通过对管道中的指令列表`改变读写顺序`就可以大幅节省 IO 时间**。管道中指令越多，效果越好。
